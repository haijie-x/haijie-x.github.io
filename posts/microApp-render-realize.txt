1:HL["/_next/static/media/c9a5bc6a7c948fb0-s.p.woff2",{"as":"font","type":"font/woff2"}]
2:HL["/_next/static/css/34c9aa3dac019c99.css",{"as":"style"}]
0:["JXPeZoXc9Nz75w5nwf-9S",[[["",{"children":["posts",{"children":[["slug","microApp-render-realize","c"],{"children":["__PAGE__?{\"slug\":[\"microApp-render-realize\"]}",{}]}]}]},"$undefined","$undefined",true],"$L3",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/34c9aa3dac019c99.css","precedence":"next"}]],["$L4",["$","meta",null,{"name":"next-size-adjust"}]]]]]]
5:I{"id":"8112","chunks":["553:static/chunks/553-b75a1ab1e88d23c9.js","185:static/chunks/app/layout-ae43402e7109a0fc.js"],"name":"","async":false}
6:I{"id":"9553","chunks":["553:static/chunks/553-b75a1ab1e88d23c9.js","185:static/chunks/app/layout-ae43402e7109a0fc.js"],"name":"","async":false}
7:I{"id":"1588","chunks":["272:static/chunks/webpack-ba6ac5b5713db877.js","417:static/chunks/44856608-9ee913c47fa02561.js","920:static/chunks/920-b802bbbd4288d489.js"],"name":"","async":false}
8:I{"id":"4737","chunks":["272:static/chunks/webpack-ba6ac5b5713db877.js","417:static/chunks/44856608-9ee913c47fa02561.js","920:static/chunks/920-b802bbbd4288d489.js"],"name":"","async":false}
3:[["$","html",null,{"lang":"en","children":[["$","link",null,{"rel":"icon","href":"/logo.svg","type":"image/x-icon"}],["$","title",null,{"children":"Hai"}],["$","body",null,{"className":"antialiased min-h-screen bg-white text-slate-900 __className_a64ecd","children":["$","div",null,{"className":"max-w-2xl mx-auto py-10 px-4","children":[["$","header",null,{"children":["$","div",null,{"className":"flex items-center justify-between","children":[["$","$L5",null,{}],["$","nav",null,{"className":"ml-auto text-sm font-medium space-x-6","children":[["$","$L6",null,{"href":"/","children":"Home"}],["$","$L6",null,{"href":"/about","children":"About"}]]}]]}]}],["$","main",null,{"children":["$","$L7",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L8",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L7",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L8",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L7",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children",["slug","microApp-render-realize","c"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L8",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$L9",null],"segment":"__PAGE__?{\"slug\":[\"microApp-render-realize\"]}"},"styles":[]}],"segment":["slug","microApp-render-realize","c"]},"styles":[]}],"segment":"posts"},"styles":[]}]}],["$","footer",null,{"className":"mt-10","children":[["$","hr",null,{"className":"my-4"}],["$","small",null,{"className":"flex justify-between","children":["@ Hai",["$","nav",null,{"className":"underline decoration-1","children":[["$","$L6",null,{"href":"https://github.com/haijie-x","className":"mr-3","children":"github"}],["$","$L6",null,{"href":"https://twitter.com/__haijie","children":"twitter"}]]}]]}]]}]]}]}]]}],null]
4:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"Micro Front-End - MicroApp render realize"}],["$","meta","2",{"name":"description","content":"MicroAppå¾®å‰ç«¯æ¡†æ¶æ¸²æŸ“æŒ‚è½½å®ç°ï¼ˆWebComponentæ–°ç‰¹æ€§ï¼‰"}],["$","meta","3",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
9:["$","article",null,{"className":"py-6 prose dark:prose-invert","children":[["$","h1",null,{"className":"mb-4 break-all","children":"Micro Front-End - MicroApp render realize"}],["$","p",null,{"className":"text-slate-700","children":"MicroAppå¾®å‰ç«¯æ¡†æ¶æ¸²æŸ“æŒ‚è½½å®ç°ï¼ˆWebComponentæ–°ç‰¹æ€§ï¼‰"}],["$","hr",null,{"className":"my-4"}],[["$","p",null,{"children":["å…³äºå¾®å‰ç«¯çš„ä¸åŒè§£å†³æ–¹æ¡ˆæ€»ç»“ï¼Œå¯ä»¥ç»“åˆä¸‹æˆ‘ä¹‹å‰çš„æ–‡ç«  ->\n",["$","a",null,{"href":"https://juejin.cn/post/7149531106105098277?share_token=77b5ab8b-e8ba-4538-b983-ad0dd981ef44","children":"ğŸ‘¾ æµ…è°ˆå¾®å‰ç«¯è§£å†³æ–¹æ¡ˆ"}]]}],"\n",["$","h3",null,{"children":"WebComponent ä»‹ç»ï¼š"}],"\n",["$","p",null,{"children":"æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨æ–°ç‰¹æ€§ CustomElement è‡ªå®šä¹‰ä¸€ä¸ª html æ ‡ç­¾ï¼Œæ¥è¡¨ç¤ºä¸€ä¸ªåŸç”Ÿç»„ä»¶ï¼Œä»¥æ­¤æ¥ä»£æ›¿å¦‚ä»Šæ¡†æ¶ä¸­ Reactã€vue ä¸­çš„ç»„ä»¶ã€‚"}],"\n",["$","h3",null,{"children":"å¦‚ä½•ä½¿ç”¨ï¼Ÿ"}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-js","children":"class microApp extends HTMLElement {\n  constructor() {\n    super()\n  }\n}\n"}]}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-js","children":"window.customElements.define(\"micro-app\", microApp)\n"}]}],"\n",["$","p",null,{"children":"è¿™æ ·æˆ‘ä»¬åœ¨æ¨¡æ¿ä¸­å°±å¯ä»¥ä½¿ç”¨äº†ï¼"}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-js","children":"<micro-app></micro-app>\n"}]}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"æœ‰æ„æ€çš„æ˜¯ï¼Œè¿™ä¸ªåŸç”Ÿç»„ä»¶ä¸æˆ‘ä»¬æ¡†æ¶ä¸­çš„ç»„ä»¶ä¸€æ ·ï¼Œæœ‰ç€è‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸé’©å­ã€‚"}]}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"connectedCallbackï¼šå½“ç»„ä»¶è¢«æ’å…¥åˆ°æ–‡æ¡£ä¸­è§¦å‘ï¼Œæœ‰åˆ©äºæˆ‘ä»¬è¿›è¡Œä»£ç åˆå§‹åŒ–ã€‚"}]}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"disconnectedCallbackï¼šå½“ç»„ä»¶ä»æ–‡æ¡£ä¸­è¢«ç§»é™¤æ—¶è§¦å‘ï¼Œæœ‰åˆ©äºæˆ‘ä»¬è¿›è¡Œä»£ç æ¸…é™¤ã€‚"}]}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"attributeChangedCallback(attrName, oldVal, newVal)ï¼šå½“ç»„ä»¶ä¸­è®¾ç½®çš„å“åº”å¼æ•°æ®å‘ç”Ÿå˜æ›´æ—¶è§¦å‘ï¼Œç»“åˆ observedAttributes å±æ€§ä¸€èµ·ä½¿ç”¨ã€‚"}]}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"adoptedCallbackï¼šå½“ç»„ä»¶è¢«æ’å…¥åˆ°ä¸€ä¸ªæ–°çš„æ–‡æ¡£ä¸­è§¦å‘ã€‚"}]}],"\n",["$","p",null,{"children":["$","code",null,{"children":"å‚è€ƒMDNä¸­Document.adoptNodeçš„APIä»‹ç»ã€‚"}]}],"\n",["$","blockquote",null,{"children":["\n",["$","h1",null,{"children":"Document.adoptNode()"}],"\n",["$","p",null,{"children":["ä»å…¶ä»–çš„ document æ–‡æ¡£ä¸­è·å–ä¸€ä¸ªèŠ‚ç‚¹ã€‚è¯¥èŠ‚ç‚¹ä»¥åŠå®ƒçš„å­æ ‘ä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹éƒ½ä¼šä»åŸæ–‡æ¡£åˆ é™¤ (å¦‚æœæœ‰è¿™ä¸ªèŠ‚ç‚¹çš„è¯), å¹¶ä¸”å®ƒçš„",["$","code",null,{"children":"ownerDocument"}],"å±æ€§ä¼šå˜æˆå½“å‰çš„ document æ–‡æ¡£ã€‚ä¹‹åä½ å¯ä»¥æŠŠè¿™ä¸ªèŠ‚ç‚¹æ’å…¥åˆ°å½“å‰æ–‡æ¡£ä¸­ã€‚"]}],"\n"]}],"\n",["$","h4",null,{"children":"æ­¥å…¥æœ¬æ–‡ä¸»é¢˜ï¼šå®ç°ä¸€ä¸ªè¿·ä½ ç‰ˆçš„ microAppã€‚"}],"\n",["$","h3",null,{"children":"microApp æ ¸å¿ƒè¦ç‚¹ï¼šå·§å¦™åˆ©ç”¨ CustomElementï¼Œä½¿ç”¨ htmlEntry+å„ç§éš”ç¦»æœºåˆ¶å®ç°å­åº”ç”¨æŒ‚è½½ã€è¿è¡Œä¸å¸è½½ã€‚"}],"\n",["$","h3",null,{}],"\n",["$","p",null,{"children":"é¦–å…ˆæˆ‘ä»¬æ€è€ƒï¼Œä¸ºä»€ä¹ˆå¾®å‰ç«¯å’Œ webcomponent æ‰¯ä¸Šäº†å…³ç³»ï¼Ÿ"}],"\n",["$","p",null,{"children":[["$","strong",null,{"children":"å›¾å‡ºè‡ª microApp å®˜ç½‘"}],"\n",["$","img",null,{"src":"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7e0201dfb54d4cf69dc8c4e82a5ec985~tplv-k3u1fbpfcp-watermark.image?","alt":"image.png"}]]}],"\n",["$","p",null,{"children":"å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åˆ©ç”¨äº† webcomponent åŸç”Ÿç»„ä»¶ç‰¹æ€§ï¼Œæ¥å……å½“ä¸€ä¸ªåŸºåº§åº”ç”¨ä¸å­åº”ç”¨çš„åª’ä»‹ï¼Œå› ä¸ºå…¶å…·æœ‰å¤©ç„¶çš„åŸç”Ÿæ”¯æŒï¼Œå¯ä»¥ç›´æ¥è¢«æ³¨å†Œåœ¨åŸºåº§ä¹‹ä¸­ï¼Œé€šä¿¡ä¹Ÿå˜å¾—ååˆ†è½»æ¾ï¼Œå¤©ç„¶çš„ç”Ÿå‘½å‘¨æœŸé’©å­ä½¿å¾—å®ƒå¯ä»¥è¿›è¡Œå­åº”ç”¨ä¸åŒçŠ¶æ€çš„æµè½¬æ“ä½œã€‚"}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"æœ¬æ–‡ä¸»è¦å®ç°çš„æ˜¯å¯¹äºå­åº”ç”¨çš„æŒ‚è½½æ¸²æŸ“æ“ä½œï¼Œè‡ªç„¶ä½¿ç”¨åˆ°çš„ä¾¿æ˜¯ webcomponent çš„ connectedCallback é’©å­ã€‚"}]}],"\n",["$","p",null,{"children":"ä¸‹é¢æ¥çœ‹å…·ä½“å¦‚ä½•å®ç°ï¼Œè¿™è¾¹æˆ‘ä»¬ä½¿ç”¨ html ç¼–å†™åŸºåº§ï¼Œvue3 ç¼–å†™å­åº”ç”¨ã€‚"}],"\n",["$","p",null,{"children":"åŸºåº§ä»£ç å¦‚ä¸‹ï¼š"}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-js","children":"<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>å¾®å‰ç«¯è§£å†³æ–¹æ¡ˆ -WebComponent</title>\n</head>\n<script src=\"./index.mjs\" type=\"module\"></script>\n<body>\n    <div>å¾®å‰ç«¯è§£å†³æ–¹æ¡ˆ -WebComponent</div>\n    <div>\n      // active-url è¡¨ç¤ºå­åº”ç”¨æ¿€æ´»url\n      <micro-app active-url=\"http://127.0.0.1:8002/\"></micro-app>\n    </div>\n</body>\n</html>\n"}]}],"\n",["$","p",null,{"children":"å­åº”ç”¨ä»£ç å¦‚ä¸‹ï¼š"}],"\n",["$","p",null,{"children":"main.js"}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-js","children":"import { createApp } from \"vue\"\nimport App from \"./App.vue\"\nimport ElementPlus from \"element-plus\"\nimport \"element-plus/dist/index.css\"\n\ncreateApp(App).use(ElementPlus).mount(\"#app\")\n"}]}],"\n",["$","p",null,{"children":"webpack.config.js"}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-js","children":"module.exports = {\n  devServer: {\n    port: 8002,\n    headers: {\n      \"Access-Control-Allow-Origin\": \"*\",\n    },\n  },\n}\n"}]}],"\n",["$","p",null,{"children":"microApp ç»„ä»¶ä»£ç ï¼š"}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-js","children":"import { fetchHtml, executeScript } from \"./fetch.mjs\"\n\nclass microApp extends HTMLElement {\n  // å­åº”ç”¨æ¿€æ´»url\n  get activeUrl() {\n    return this.getAttribute(\"active-url\")\n  }\n  // éœ€è¦è¢«ç›‘å¬çš„å±æ€§æ”¾åœ¨è¿™é‡Œå®šä¹‰\n  static get observedAttributes() {\n    // return ['name']\n  }\n  get container() {\n    return this.shadowRoot\n  }\n  constructor() {\n    super()\n  }\n  // ç”Ÿå‘½å‘¨æœŸé’©å­ï¼š componentè¢«æ’å…¥domä¸­è§¦å‘\n  async connectedCallback() {\n    // æ³¨æ„:getAttributeåªèƒ½åœ¨è¿™æ—¶å€™æ‹¿åˆ°\n    // this.activeUrl = this.getAttribute(\"active-url\");\n    const temp = await this.load()\n    this.bootstrap(temp)\n    Promise.resolve().then(() => {\n      this.mount()\n    })\n  }\n  // åŠ è½½èµ„æº\n  async load() {\n    const temp = await fetchHtml(this.activeUrl)\n    return temp\n  }\n  // åˆå§‹åŒ–å­åº”ç”¨\n  bootstrap(temp) {\n    // åˆ›å»ºæ–‡æ¡£ç‰‡æ®µæ’å…¥ç»„ä»¶ä¸­\n    const template = document.createElement(\"template\")\n    template.innerHTML = temp\n    const fra = document.createDocumentFragment()\n    fra.appendChild(template.content.cloneNode(true))\n    this.appendChild(fra)\n  }\n  // æŒ‚è½½å­åº”ç”¨\n  mount() {\n    // æ‰§è¡Œç›¸å…³script\n    executeScript(document)\n  }\n}\nwindow.customElements.define(\"micro-app\", microApp)\n"}]}],"\n",["$","p",null,{"children":"å·¥å…·å‡½æ•°ï¼š"}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-js","children":"// ä¿å­˜scriptè„šæœ¬\nconst sourceSet = new Set()\n\n// å°è£…è¯·æ±‚èµ„æº\nasync function fetchResource(url) {\n  const res = await fetch(url)\n  // res.text ä¹Ÿæ˜¯ä¸€ä¸ªpromise\n  return res.text()\n}\n\n// è¯·æ±‚htmlæ–‡ä»¶\nexport async function fetchHtml(url) {\n  let template = await fetchResource(url)\n  return resolveScript(template, url)\n}\n\n// å¯¹htmlæºç è¿›è¡Œå¤„ç†\nexport function resolveScript(template, activeUrl) {\n  return template\n    .replace(/<head[^>]*>[\\s\\S]*?<\\/head>/i, (match) => {\n      return match\n        .replace(/<head/i, \"<micro-app-head\")\n        .replace(/<\\/head>/i, \"</micro-app-head>\")\n    })\n    .replace(/<body[^>]*>[\\s\\S]*?<\\/body>/i, (match) => {\n      return match\n        .replace(/<body/i, \"<micro-app-body\")\n        .replace(/<\\/body>/i, \"</micro-app-body>\")\n    })\n    .replace(/src=\"(.*?)\"/g, (_, text) => {\n      sourceSet.add(`${activeUrl}${text}`)\n      return `src=\"${activeUrl}${text}\"`\n    })\n    .replace(/href=\"(.*?)\"/g, (_, text) => {\n      return `href=\"${activeUrl}${text}\"`\n    })\n}\n\n// åŒ…è£…æ‰€æœ‰scriptè„šæœ¬\nfunction getExternalScript() {\n  return Promise.all(Array.from(sourceSet).map((url) => fetchResource(url)))\n}\n\n// æ‰§è¡Œè„šæœ¬\nexport async function executeScript(document) {\n  const scripts = await getExternalScript()\n  scripts.forEach((code) => {\n    ;(function (document) {\n      eval(code)\n    })(document)\n  })\n}\n"}]}],"\n",["$","p",null,{"children":["æœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼š\n",["$","img",null,{"src":"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4c171a675b1e497fb956fdcca60fcbf6~tplv-k3u1fbpfcp-watermark.image?","alt":"image.png"}]]}]]]}]
